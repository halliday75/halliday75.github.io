<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AAC Web App - Friendly Layout</title>
<style>
  body { font-family: Arial,sans-serif; background:#f4f9ff; margin:0; padding:15px; display:flex; flex-direction:column; align-items:center; }
  
  /* Sentence bar at top */
  #sentence-bar { display:flex; align-items:center; background:white; border-radius:16px; padding:15px; width:95%; max-width:1000px; box-shadow:0 4px 8px rgba(0,0,0,0.1); margin-bottom:15px; flex-wrap:wrap; }
  #sentence-text { flex:1; font-size:24px; font-weight:bold; min-height:32px; margin-right:10px; }
  #sentence-bar button { font-size:18px; margin:5px; padding:12px 18px; border:none; border-radius:12px; cursor:pointer; color:white; }

  #speak-btn { background:#2a9d8f; }
  #clear-btn { background:#f4a261; }
  #stop-btn { background:#e63946; }
  #mode-btn { background:#1d3557; }

  /* Settings panel floating at bottom */
  #settings-panel { display:none; position:fixed; bottom:15px; left:50%; transform:translateX(-50%); background:white; border-radius:16px; padding:20px; width:90%; max-width:400px; box-shadow:0 4px 12px rgba(0,0,0,0.2); z-index:10; }
  #settings-panel h2 { margin-top:0; font-size:20px; text-align:center; }

  /* AAC buttons grid */
  .container { display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:20px; width:95%; max-width:1000px; }
  .aac-btn { display:flex; flex-direction:column; align-items:center; justify-content:center; padding:15px; background:white; border-radius:16px; box-shadow:0 4px 8px rgba(0,0,0,0.15); cursor:pointer; transition:transform 0.2s; position:relative; text-align:center; min-height:130px; }
  .aac-btn:hover { transform:scale(1.05); background:#eaf4ff; }
  .aac-btn img { width:90px; height:90px; object-fit:contain; margin-bottom:10px; }
  .aac-btn span { font-size:18px; font-weight:bold; text-align:center; }

  .delete-btn { display:none; position:absolute; top:6px; right:6px; background:red; color:white; border:none; border-radius:50%; width:26px; height:26px; cursor:pointer; }
  .edit-mode .delete-btn { display:block; }

  @media(max-width:600px){ 
    .container { grid-template-columns:1fr 1fr; }
    .aac-btn img { width:70px; height:70px; }
  }
</style>
</head>
<body>

<!-- Sentence Bar -->
<div id="sentence-bar">
  <div id="sentence-text"></div>
  <button id="speak-btn" onclick="speakSentence()">üîä Speak</button>
  <button id="clear-btn" onclick="clearSentence()">‚ùå Clear</button>
  <button id="stop-btn" onclick="stopSpeech()">üõë Stop</button>
  <button id="mode-btn" onclick="toggleMode()">üìù Mode: Sentence</button>
  <button id="settings-toggle" onclick="togglePanel('settings-panel')">‚öôÔ∏è</button>
</div>

<!-- Settings Panel -->
<div id="settings-panel">
  <h2>Speech Settings</h2>
  <label>Voice: <select id="voiceSelect" onchange="saveSettings()"></select></label><br><br>
  <label>Rate: <input id="rateRange" type="range" min="0.5" max="2" step="0.1" value="1" onchange="saveSettings()"></label><br><br>
  <label>Pitch: <input id="pitchRange" type="range" min="0.5" max="2" step="0.1" value="1" onchange="saveSettings()"></label>
</div>

<!-- Buttons Grid -->
<div class="container" id="aac-container"></div>

<script>
const container = document.getElementById("aac-container");
const sentenceText = document.getElementById("sentence-text");
const voiceSelect = document.getElementById("voiceSelect");
const rateRange = document.getElementById("rateRange");
const pitchRange = document.getElementById("pitchRange");

let voices = [], sentence = [];

// Load buttons/settings from localStorage
let aacButtons = JSON.parse(localStorage.getItem("aac_buttons")) || [
  {text:"Hello", img:"https://img.icons8.com/color/96/hello.png"},
  {text:"I want", img:"https://img.icons8.com/color/96/hand.png"},
  {text:"food", img:"https://img.icons8.com/color/96/hamburger.png"},
  {text:"water", img:"https://img.icons8.com/color/96/water.png"},
  {text:"bathroom", img:"https://img.icons8.com/color/96/toilet.png"},
  {text:"help", img:"https://img.icons8.com/color/96/helping-hand.png"}
];

let settings = JSON.parse(localStorage.getItem("aac_settings")) || {
  mode: "sentence",
  voiceIndex: 0,
  rate: 1,
  pitch: 1
};
let mode = settings.mode;

// Render AAC buttons
function renderButtons(){
  container.innerHTML="";
  aacButtons.forEach((btn, i)=>{
    const div=document.createElement("div");
    div.className="aac-btn";
    div.innerHTML=`<img src="${btn.img}" alt=""><span>${btn.text}</span>`;
    div.onclick=()=>{ if(mode==="sentence") addToSentence(btn.text); else speakWord(btn.text); };
    container.appendChild(div);
  });
}

// Sentence functions
function addToSentence(word){ sentence.push(word); sentenceText.textContent = sentence.join(" "); }
function clearSentence(){ sentence=[]; sentenceText.textContent = ""; }
function speakSentence(){
  if(!sentence.length) return;
  stopSpeech();
  const u=new SpeechSynthesisUtterance(sentence.join(" "));
  u.voice=voices[voiceSelect.selectedIndex] || null;
  u.rate=parseFloat(rateRange.value); u.pitch=parseFloat(pitchRange.value);
  window.speechSynthesis.speak(u);
}
function speakWord(word){
  stopSpeech();
  const u=new SpeechSynthesisUtterance(word);
  u.voice=voices[voiceSelect.selectedIndex] || null;
  u.rate=parseFloat(rateRange.value); u.pitch=parseFloat(pitchRange.value);
  window.speechSynthesis.speak(u);
}
function stopSpeech(){ if('speechSynthesis' in window) window.speechSynthesis.cancel(); }

// Mode toggle
function toggleMode(){ 
  mode=(mode==="sentence")?"on-demand":"sentence";
  document.getElementById("mode-btn").textContent=`üìù Mode: ${mode==="sentence"?"Sentence":"On-Demand"}`;
  settings.mode=mode; saveSettings();
}

// Settings
function togglePanel(id){ const el=document.getElementById(id); el.style.display=(el.style.display==="block")?"none":"block"; }
function saveSettings(){
  settings.voiceIndex = voiceSelect.selectedIndex;
  settings.rate = parseFloat(rateRange.value);
  settings.pitch = parseFloat(pitchRange.value);
  settings.mode = mode;
  localStorage.setItem("aac_settings", JSON.stringify(settings));
}

// Voices
function loadVoices(){
  if(!('speechSynthesis' in window)) return;
  voices=window.speechSynthesis.getVoices()||[];
  voiceSelect.innerHTML="";
  voices.forEach((v,i)=>{
    const o=document.createElement("option");
    o.textContent=`${v.name} (${v.lang})`;
    voiceSelect.appendChild(o);
  });
  if(settings.voiceIndex<voices.length) voiceSelect.selectedIndex=settings.voiceIndex;
  rateRange.value=settings.rate;
  pitchRange.value=settings.pitch;
  toggleMode(); // apply saved mode
}
speechSynthesis.onvoiceschanged=loadVoices;

// Init
renderButtons();
loadVoices();
</script>
</body>
</html>
